---
- name: Configure DNS servers
  hosts: dns
  become: yes
  roles:
    - powerdns-authoritative
    - powerdns-recursor

- name: Configure DHCP servers
  hosts: dhcp
  become: yes
  roles:
    - kea-dhcp
    - kea-exporter

- name: Configure apt-proxy cache servers
  hosts: apt_proxy
  become: yes
  roles:
    - apt-cacher-ng

- name: Configure git
  hosts: git
  become: yes
  roles:
    - gitlab

- name: Configure IPAM
  hosts: ipam
  become: yes
  roles:
    - netbox
    - vcenter-netbox-sync

- name: Configure Wiki
  hosts: wiki
  become: yes
  roles:
    - wikijs

- name: Configure Blog
  hosts: blog
  become: yes
  roles:
    - ghost

- name: Configure VPN
  hosts: vpn
  become: yes
  roles:
    - wireguard
    - wireguard-exporter
    - exporter-exporter

- name: Configure Log
  hosts: log
  become: yes
  roles:
    - graylog

- name: Configure Monitoring
  hosts: monitoring
  become: yes
  roles:
    - prometheus
    - grafana
    - snmp-exporter
    - blackbox-exporter
    - fping-exporter
    - vmware-exporter
    - unifi-poller
    - tplink-plug-exporter

- name: Configure kubernetes loadbalancers
  hosts: kubernetes:&lb
  become: yes
  roles:
    - pacemaker
    - haproxy

- name: Configure kubernetes etcd
  hosts: kubernetes:&etcd
  become: yes
  roles:
    - kubernetes-etcd

- name: Configure kubernetes master
  hosts: kubernetes:&master
  become: yes
  roles:
    - kubernetes-master
    - istio

- name: Configure kubernetes worker
  hosts: kubernetes:&worker
  become: yes
  roles:
    - kubernetes-worker