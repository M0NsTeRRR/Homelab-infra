---
- name: Open required ports
  community.general.ufw:
    rule: allow
    port: "161"
    proto: udp

- name: Install snmpd
  ansible.builtin.apt:
    name: snmpd
    state: present

- name: Configure snmpd
  ansible.builtin.template:
    src: snmpd.conf.j2
    dest: /etc/snmp/snmpd.conf
    mode: '0600'
  notify: restart snmpd